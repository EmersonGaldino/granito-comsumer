version: 0.2

env:
    variables:
        PROJECT: granito.consumer.api

phases:   
    pre_build:
        commands:
            - echo Restore started on `date`
            - dotnet restore
            - 
#                
#    uniTest:
#        commands:
#            - echo test started on `date`
#            - dotnet test -c Release --logger trx --results-directory ./testresults
      
    build:
        commands:
            - echo Build started on `date`
            - dotnet build -c Release
            - dotnet test -c Release --logger trx --results-directory ./testresults
      
    post_build:
        commands:
            - echo Publish started on `date`
            - dotnet publish -c Release  -r linux-x64 -o ./build_output ./granito.consumer.api/granito.consumer.api.csproj --self-contained false

artifacts:
    files:
        - '**/*'
    base-directory: ./build_output
    discard-paths: no